# 图像识别大课设

本项目是一个基于深度学习的图像识别系统，使用PyTorch构建模型，Flask提供Web界面，实现了从数据准备、模型配置、训练到预测的完整工作流程。

## 项目架构

```
图像识别大课设/
├── app.py                  # Flask应用主文件
├── requirements.txt        # 项目依赖
├── models/                 # 模型定义文件夹
│   └── cnn_models.py       # CNN模型定义
├── utils/                  # 工具函数文件夹
│   ├── data_utils.py       # 数据处理工具
│   └── train_utils.py      # 训练工具
├── templates/              # HTML模板文件夹
│   ├── index.html          # 首页
│   ├── prepare_data.html   # 数据准备页面
│   ├── config.html         # 模型配置页面
│   ├── train.html          # 训练页面
│   ├── results.html        # 结果展示页面
│   └── predict.html        # 图像预测页面
├── static/                 # 静态资源文件夹
│   ├── uploads/            # 上传的图像
│   └── ...                 # 生成的结果和图表
└── data/                   # 数据集文件夹
    ├── train/              # 训练数据
    └── test/               # 测试数据
```

## 功能特性

1. **数据准备**：支持下载CIFAR-10示例数据集或使用自定义数据集
2. **模型配置**：提供三种不同复杂度的CNN模型，可配置各种训练参数
3. **模型训练**：可视化训练过程，实时显示损失值和准确率
4. **结果分析**：展示训练曲线、混淆矩阵和分类报告
5. **图像预测**：支持上传图像进行预测，显示详细的分类概率

## 模型介绍

### 1. SimpleCNN
- 2个卷积层
- 2个全连接层
- 适用于简单场景和快速测试

### 2. ImprovedCNN
- 4个卷积层
- 3个全连接层
- 添加了BatchNorm和Dropout
- 适用于中等复杂度的分类任务

### 3. AdvancedCNN
- 基于ResNet风格的残差块设计
- 多个卷积层组
- 包含BatchNorm和Dropout
- 适用于复杂的分类任务

## 依赖安装

1. 确保已安装Python 3.7+
2. 安装依赖包：

```bash
pip install -r requirements.txt
```

## 使用步骤

### 1. 准备数据集

运行应用后，在Web界面的"数据准备"页面：
- 点击"下载示例数据集"自动获取CIFAR-10的一个子集
- 或选择"使用自定义数据集"，将你的图像按类别放在`data/train/`和`data/test/`文件夹中

### 2. 配置模型

在"模型配置"页面：
- 选择模型类型（SimpleCNN、ImprovedCNN或AdvancedCNN）
- 设置训练参数：批次大小、学习率、训练轮数
- 选择优化器（Adam或SGD）

### 3. 训练模型

在"模型训练"页面：
- 查看当前配置参数
- 点击"开始训练"按钮
- 实时观察训练进度、损失值和准确率变化

### 4. 查看结果

训练完成后，在"训练结果"页面：
- 查看最终性能指标
- 分析训练曲线（损失值和准确率随时间的变化）
- 查看混淆矩阵
- 查看各类别的详细性能分析

### 5. 进行预测

在"图像预测"页面：
- 上传一张图像或选择示例图像
- 点击"开始预测"按钮
- 查看预测结果、置信度和各类别的概率分布

## 运行应用

```bash
cd 图像识别大课设
python app.py
```

然后在浏览器中访问 http://localhost:5000

## 注意事项

1. 训练过程可能需要较长时间，取决于模型复杂度和数据量
2. 确保有足够的磁盘空间存储数据集和模型
3. 对于大型数据集，建议使用GPU进行训练
4. 上传的图像大小不应超过5MB，支持JPG、PNG和WEBP格式

## 技术栈

- **后端**：Python, Flask
- **深度学习**：PyTorch, torchvision
- **前端**：HTML5, CSS3, JavaScript, Bootstrap
- **数据可视化**：Matplotlib, Chart.js

## 项目扩展

可以通过以下方式扩展本项目：
1. 添加更多类型的神经网络模型
2. 实现数据增强功能
3. 添加模型导出和导入功能
4. 优化前端交互体验
5. 部署到生产环境

## 许可证

本项目仅供学习和研究使用。